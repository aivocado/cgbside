<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="HongJu Lee">
<meta name="author" content="Sumin Hong">
<meta name="author" content="Hwajeong Lee">
<meta name="dcterms.date" content="2023-11-21">

<title>CGBeta - 1121_Data Plan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/main_logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">기술문서</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="../../overview.html" rel="" target="">
 <span class="dropdown-text">개발개요</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../data.html" rel="" target="">
 <span class="dropdown-text">데이터</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">KPMG Capstone Project</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
    <a href="https://github.com/aivocado/cgbside" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">1121_Data Plan</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Authors</div>
      <div class="quarto-title-meta-contents">
               <p>HongJu Lee </p>
               <p>Sumin Hong </p>
               <p>Hwajeong Lee </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 21, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="개발환경-설정" class="level1">
<h1>개발환경 설정</h1>
</section>
<section id="중요-api-사용방법-익히기" class="level1">
<h1>중요 : API 사용방법 익히기</h1>
<ul>
<li>openai api</li>
<li>법령정보 API 받아오는 방법
<ul>
<li><a href="https://open.law.go.kr/LSO/main.do">https://open.law.go.kr/LSO/main.do</a>(api, 국가법령정보 공동활용 홈페이지)</li>
<li>회원가입 필수!</li>
</ul></li>
</ul>
</section>
<section id="todo" class="level1">
<h1>TODO</h1>
<ul>
<li>개발환경 설정 (IDE, 개발언어, 패키지, 코드 저장소 등등)</li>
<li>Data Ingestion 및 EDA</li>
<li>국가법령사무예측 예측개발 방법론: 예측모형 전반 (모형 가치, global model, many models, etc)</li>
<li>국가법령사무예측 모형 설계서 (EDA 바탕 Feature Engineering, ML 모형, performance metrics, 등등)</li>
</ul>
<section id="개발환경설정" class="level2">
<h2 class="anchored" data-anchor-id="개발환경설정">개발환경설정</h2>
<ul>
<li>개발언어 : Python</li>
<li>IDE : Anaconda, VSCode</li>
<li>패키지 : numpy, pandas, scikit-learn, pytorch, transformers(hugging face)</li>
<li>코드 공유 및 코드 저장소: github - cgbside repo</li>
</ul>
</section>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<section id="source" class="level3">
<h3 class="anchored" data-anchor-id="source">0. Source</h3>
<ul>
<li>edaing.ipynb</li>
<li>final.pdf</li>
<li>codebook_2022.xlsx</li>
</ul>
</section>
<section id="law_mst.csv-파일-로드" class="level3">
<h3 class="anchored" data-anchor-id="law_mst.csv-파일-로드">1. Law_MST.csv 파일 로드</h3>
<pre><code>- 349810행 호출 오류
    
    &gt;💡 "251889","001740",해양수산부,선원법,"0007001",④,제7조,출항 전의 검사ㆍ보고의무 등,"제7조(출
    ~~→ “” (따옴표)로 감싸지 않아서 파싱 과정에서 오류가 발생 (잘못 복사된 파일)~~
    * 파일의 EOF가 잘못 설정되어 이를 수정함 
    ⇒ 혹시 349810행 뒤에 짤린 부분이 있는지 확인 필요
    
- 따라서, 이를 제외하고 csv 파일을 로드하였음.
    
    ```python
    data = pd.read_csv('law_mst.csv')
    ```
    
- Output
    
    ![결과](output1.png)
    </code></pre>
</section>
<section id="feature-설명" class="level3">
<h3 class="anchored" data-anchor-id="feature-설명">2. Feature 설명</h3>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>설명</th>
<th>처리방법</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>law_seq</td>
<td>법률, 시행규칙, 시행규칙 전체 연번</td>
<td>정확히 무엇인지?</td>
</tr>
<tr class="even">
<td>law_id</td>
<td>(법마다 다르다)</td>
<td>정확히 무엇인지?</td>
</tr>
<tr class="odd">
<td>jdt_dept_nm</td>
<td>소관부처 부처 개수, 부처명 등 파악하기</td>
<td></td>
</tr>
<tr class="even">
<td>law_kor_nm</td>
<td>법령명</td>
<td></td>
</tr>
<tr class="odd">
<td>provision_key_no</td>
<td>포맷 : _ _ _ _ _ _ _ <br>(1) _ _ _ _ /_ _ 앞 6자리 숫자: 조(4자리)의 몇(2자리)<br>ex) 제 1000조의 1 : 1000 / 01<br>ex) 제 1조 : 0001 / 00<br>ex) 제 15조의 19 : 0015 / 19<br>(2) _ 맨 뒤 1자리 숫자: 0 -&gt; 장, 1-&gt; 장 아님</td>
<td><br>-맨 뒤 숫자가 1인 경우, 조 번호만 추출<br>-맨 뒤 숫자가 0인 경우, 행 삭제</td>
</tr>
<tr class="even">
<td>clause_no</td>
<td>원숫자 <br>O → 각 항번호 <br>1 → 항 없이 호만 있음<br>nan → 항과 호 모두 없는 법령</td>
<td></td>
</tr>
<tr class="odd">
<td>provision_no_nm</td>
<td>조 한국어 표기(ex. 제1조, 제2조)</td>
<td></td>
</tr>
<tr class="even">
<td>provision_title</td>
<td>조 제목</td>
<td></td>
</tr>
<tr class="odd">
<td>provision_cont</td>
<td>조 내용</td>
<td></td>
</tr>
<tr class="even">
<td>clause_cont</td>
<td>항 내용</td>
<td></td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="law_cat.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">참고 : 대한민국 법조문 체계</figcaption>
</figure>
</div>
<p><em>+ 대한민국 정부 조직도 체계 참고사항으로 넣기</em></p>
<p><em>+ 정부조직이 업데이트 시(승격 등), 어떻게 반영할 것인지?</em></p>
<p><em>+ 시군구 업데이트 시(승격 등), 어떻게 반영할 것인지?</em></p>
<p><em>+ 업데이트 될 때마다 바로 반영이 가능한가?</em></p>
<p><em>+ 그리고 현재, Law_MST.csv에는 따로 사무여부 등의 레이블링이 되어있지 않은데 그렇다면 학습용데이터는 2019년 자료를 활용해야 하는 것인가?</em></p>
<p><em>그렇다면.. 우리가 학습해야 할 데이터는.. 2019사무목록 최종본(인쇄용 최종).xlsx 파일인데 (레이블링이 되어 있으니) 그렇다면 Law_MST.csv는 어디에 사용하는 걸까?</em></p>
</section>
<section id="eda---excel-파일" class="level3">
<h3 class="anchored" data-anchor-id="eda---excel-파일">3. EDA - excel 파일</h3>
<ol type="1">
<li>결측치 확인: ‘항’, ‘비고’ column만 null값 존재</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ouput2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">출력 결과</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>unique값 확인</li>
</ol>
<ul>
<li>조문 제목과 사무 유형은 동일한 내용임에도 띄어쓰기가 다르게 되어 있는 경우 있었음 ⇒ replace 함수 통해 띄어쓰기 제거</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>column명</th>
<th>원래 unique 값</th>
<th>띄어쓰기 없앤 후 unique 값</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>소관부서</td>
<td>41</td>
<td>41</td>
</tr>
<tr class="even">
<td>법령</td>
<td>2859</td>
<td>2859</td>
</tr>
<tr class="odd">
<td>조문제목</td>
<td>30034</td>
<td>29544</td>
</tr>
<tr class="even">
<td>사무명</td>
<td>56789</td>
<td>56418</td>
</tr>
<tr class="odd">
<td>사무유형</td>
<td>33</td>
<td>16</td>
</tr>
<tr class="even">
<td>비고</td>
<td>4036</td>
<td>3843</td>
</tr>
</tbody>
</table>
<p>+) 비고의 경우, 오탈자 존재(ex. 가획재정부 장관) / 동일한 기관 다른 표기 존재(ex.기획재정부 장관, 기재부 장관)</p>
</section>
<section id="eda를-통해-세운-전처리모델링-전략" class="level3">
<h3 class="anchored" data-anchor-id="eda를-통해-세운-전처리모델링-전략">4. EDA를 통해 세운 전처리/모델링 전략</h3>
<ol type="1">
<li><p>‘소관부처’, ‘법령’, ‘비고’ 라벨 인코딩하여 사무 유형 classification 진행해보고자 함</p></li>
<li><p>law_mst.csv 파일과 2019사무목록 최종본.xlsx 파일의 연도 정보가 일치하지 않음</p></li>
<li><p>law_mst.csv 파일과 2019사무목록 최종본.xlsx 파일을 ’조와 항’을 key로 하여 left join하면 사무인지 아닌지도 파악할 수 있음 (join한 후, 사무명, 사무유형, 비고가 NaN이면 비사무)</p></li>
</ol>
<p>⇒ 그러나, 이를 위해서는 2번 문제가 해결되어야 함</p>
<ol start="4" type="1">
<li>사무명의 경우, 법령에서 괄호 속 텍스트 추출하는 방식으로 처리</li>
</ol>
<blockquote class="blockquote">
<p>2019사무목록 최종본(인쇄용 최종).xlsx</p>
</blockquote>
<ul>
<li>이 파일에는 아래와 같이 레이블링된 사무목록들이 들어있다. 하지만, 사무가 아닌 법령은 제거되어 있는 등(모든 법령들이 들어있지 않다!), 자체적으로 전처리가 되어있는 자료이다. 또한 법의 특성상(?) ’호’는 ’사무’에 대한 내용을 담고 있진 않은듯? 상위의 ’조’나 ’항’에서 ’사무명’을 추출할 수 있는 듯하다.</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>연번</th>
<th>소관부처</th>
<th>법령</th>
<th>조</th>
<th>항</th>
<th>조문제목</th>
<th>조문</th>
<th>사무명</th>
<th>사무유형</th>
<th>비고</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="예측개발-방법론" class="level2">
<h2 class="anchored" data-anchor-id="예측개발-방법론">예측개발 방법론</h2>
<p><strong>&lt;개발 목적 및 프로세스&gt;</strong></p>
<ol type="1">
<li><p>사무 여부 O/X</p></li>
<li><p>사무 여부가 O 일 때, 사무 수행 주체 파악</p>
<p>→ <strong>데이터 사전</strong> 구성? (부처에 뭐가 있는 지 미리 작성)</p></li>
<li><p>위탁 여부 파악 O/X (위탁이 O인 경우 사무 수행 주체 소분류 컬럼 추가 생성 필요)</p></li>
<li><p>사무 유형 파악</p></li>
</ol>
<p>—&gt; 부처명, 시군구 범위 변경 시에도 반영이 가능해야 함.</p>
<p>&lt;목표: 사무유형 classification : 16개 &gt;</p>
<p>**** 어떤 프로세스를 적용할까요?!***</p>
<p>** 프로세스 : 문서 구조 분석 -&gt; 엔터티 추출 및 분류 모델(NER 모델을 통한 사무주체 추출) -&gt; ‘위임’,’위탁’등의 관계를 분석하는 알고리즘(종속관계 파악하는 관계 추출 기술…?) -&gt; 모델 학습(어떤 방법론이 가능할지는?) -&gt; 모델 성능 평가 및 하이퍼파라미터 조정 -&gt; 실제 환경에 통합 및 사용자 인터페이스를 통한 결과 제공*</p>
<p>[시도 방법1] 문서 구조 분석 -&gt; 엔터티 추출 및 분류 모델(NER 모델을 통한 사무주체 추출) -&gt; ‘위임’,’위탁’등의 관계를 분석하는 알고리즘(종속관계 파악하는 관계 추출 기술…?) -&gt; 모델 학습(어떤 방법론이 가능할지는?) -&gt; 모델 성능 평가 및 하이퍼파라미터 조정 -&gt; 실제 환경에 통합 및 사용자 인터페이스를 통한 결과 제공</p>
<p>[시도 방법2] ‘소관부처’, ‘법령’, ‘비고’ 라벨인코딩 ⇒ 머신러닝 기법(XGBoost, LightGBM, 여러 모델 앙상블) 적용</p>
<p>[시도 방법3] huggingface에서 nlp 모델 사용 ⇒ 딥러닝 기법 시도</p>
</section>
<section id="모형설계서" class="level2">
<h2 class="anchored" data-anchor-id="모형설계서">모형설계서</h2>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>개발 목적/프로세스</th>
<th>개발 방법론</th>
<th>사용 모델</th>
<th>performance metric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>사무 여부 O/X</td>
<td>rule-based classification</td>
<td>if-elif <br>위임되면 사무X : ~령으로 정한다</td>
<td>f1 score, recall(사무가 맞는데 사무가 아니라고 분류되는게 더 위험하기 때문에)</td>
</tr>
<tr class="even">
<td>사무 유형 파악</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>사무 여부가 O 일 때, 사무 수행 주체 파악</td>
<td>trial1) 문장에서 주어 추출</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><br>trial2) 수행 주체 데이터 사전 구성, 데이터 사전에 있는 명사 모두 추출</td>
<td></td>
<td>accuracy (수행주체 올바르게 추출한 데이터 수 / 전체 데이터 수)</td>
<td></td>
</tr>
<tr class="odd">
<td>3) 위탁 여부 파악 O/X</td>
<td>rule-based classification(위탁이 O이면 경우에 따라 사무가 X가 될 수 있음.)</td>
<td>정규표현식 사용(‘~조에 따른’ 표현이 있으면 위탁여부 O로 classify)</td>
<td>f1 score</td>
</tr>
</tbody>
</table>
<p><strong>&lt;의문점!&gt;</strong></p>
<ul>
<li>법령정보api는 새로운 조문이 업데이트 되면 이를 학습할 목적으로 사용하는 것인지?</li>
<li>그럼 일단 학습은 기존의 2019, 2022년 정리된 조문을 바탕으로 학습하는 것인지?</li>
<li>위임, 조, 규칙, 시행령 등 서로 종속되어 있는 관계는 어떻게 학습을 하는 것인지?</li>
</ul>
<ol type="1">
<li>train / validation / test set 구분</li>
</ol>
<ul>
<li>2019사무목록 최종본(인쇄용 최종).xlsx 로 지도학습 실시 (확실하지 않음)</li>
<li>Q: 그럼 Law_MST.csv 어디에 사용?</li>
<li>Law_MST.csv로 Demo 시연</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>